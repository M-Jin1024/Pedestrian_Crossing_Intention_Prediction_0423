 cd /home/minshi/Pedestrian_Crossing_Intention_Prediction ; /usr/bin/env /home/minshi/miniconda3/envs/tf26/bin/python /home/minshi/.vscode/extensions/ms-python.debugpy-2025.14.1-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher 49619 -- /home/minshi/Pedestrian_Crossing_Intention_Prediction/train_and_test_all_epoch_pipeline.py -c config_files/my/my_jaad.yaml 
================================================================================
🎯 训练和测试管道启动
================================================================================
配置文件: config_files/my/my_jaad.yaml
开始时间: 2025-11-12 23:21:29

🚀 开始训练...
2025-11-12 23:21:32.297282: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:32.300537: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:32.300642: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   config_files/my/my_jaad.yaml
✓ 使用固定随机种子: 42
model_opts {'model': 'Transformer_depth', 'obs_input_type': ['box', 'depth', 'vehicle_speed', 'ped_speed'], 'enlarge_ratio': 1.5, 'obs_length': 16, 'time_to_ev
ent': [30, 60], 'overlap': 0.8, 'balance_data': False, 'apply_class_weights': True, 'dataset': 'jaad', 'normalize_boxes': True, 'generator': True, 'fusion_point': 'early', 'fusion_method': 'sum'}                                                                                                                           data_opts {'fstride': 1, 'sample_type': 'beh', 'subset': 'default', 'data_split_type': 'default', 'seq_type': 'crossing', 'min_track_size': 76}
net_opts {'num_hidden_units': 256, 'global_pooling': 'avg', 'regularizer_val': 0.0001, 'cell_type': 'gru', 'backbone': 'vgg16', 'dropout': 0.1}
train_opts {'batch_size': 2, 'epochs': 30, 'lr': 5e-05, 'learning_scheduler': {}}
exp_opts {'datasets': ['jaad_beh'], 'batch_size': [2], 'epochs': [30], 'lr': [5e-05], 'seed': 42}
---------------------------------------------------------
Generating action sequence data
fstride: 1
sample_type: beh
subset: default
height_rng: [0, inf]
squarify_ratio: 0
data_split_type: default
seq_type: crossing
min_track_size: 76
random_params: {'ratios': None, 'val_data': True, 'regen_data': False}
kfold_params: {'num_folds': 5, 'fold': 1}
---------------------------------------------------------
Generating database for jaad
jaad database loaded from /home/minshi/Pedestrian_Crossing_Intention_Prediction/JAAD/data_cache/jaad_database.pkl
---------------------------------------------------------
Generating crossing data
Split: train
Number of pedestrians: 324 
Total number of samples: 194 
---------------------------------------------------------
Generating action sequence data
fstride: 1
sample_type: beh
subset: default
height_rng: [0, inf]
squarify_ratio: 0
data_split_type: default
seq_type: crossing
min_track_size: 76
random_params: {'ratios': None, 'val_data': True, 'regen_data': False}
kfold_params: {'num_folds': 5, 'fold': 1}
---------------------------------------------------------
Generating database for jaad
jaad database loaded from /home/minshi/Pedestrian_Crossing_Intention_Prediction/JAAD/data_cache/jaad_database.pkl
---------------------------------------------------------
Generating crossing data
Split: val
Number of pedestrians: 48 
Total number of samples: 22 
---------------------------------------------------------
Generating action sequence data
fstride: 1
sample_type: beh
subset: default
height_rng: [0, inf]
squarify_ratio: 0
data_split_type: default
seq_type: crossing
min_track_size: 76
random_params: {'ratios': None, 'val_data': True, 'regen_data': False}
kfold_params: {'num_folds': 5, 'fold': 1}
---------------------------------------------------------
Generating database for jaad
jaad database loaded from /home/minshi/Pedestrian_Crossing_Intention_Prediction/JAAD/data_cache/jaad_database.pkl
---------------------------------------------------------
Generating crossing data
Split: test
Number of pedestrians: 276 
Total number of samples: 171 
[DataGenerator] auto class_weight -> {0: 0.8247422680412371, 1: 0.17525773195876287}
[DataGenerator] auto class_weight -> {0: 0.7272727272727273, 1: 0.2727272727272727}
2025-11-12 23:21:34.126746: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (o
neDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA                                                                     To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-12 23:21:34.128083: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:34.128305: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:34.128394: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:34.397322: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:34.397427: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:34.397503: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:21:34.397571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3946 MB m
emory:  -> device: 0, name: NVIDIA GeForce RTX 4060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.9                                              
============================================================
📊 MODEL PARAMETER STATISTICS
============================================================
Total parameters:        2,968,717
Trainable parameters:    2,968,711
Non-trainable parameters: 6
============================================================

/home/minshi/miniconda3/envs/tf26/lib/python3.8/site-packages/keras/optimizer_v2/optimizer_v2.py:355: UserWarning: The `lr` argument is deprecated, use `learni
ng_rate` instead.                                                                                                                                                warnings.warn(

🚀 Training started!
📁 Models will be saved to: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s
📋 已复制 action_predict.py 到模型目录
2025-11-12 23:21:35.575148: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
Epoch 1/30
2025-11-12 23:21:39.539988: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be l
ogged once.                                                                                                                                                    2025-11-12 23:21:39.844156: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8100
1067/1067 [==============================] - 14s 9ms/step - loss: 9.3409 - cls_loss: 0.2138 - reg_loss: 0.0115 - intention_accuracy: 0.5361 - val_loss: 5.0220 
- val_cls_loss: 0.2779 - val_reg_loss: 0.0023 - val_intention_accuracy: 0.5124                                                                                 /home/minshi/miniconda3/envs/tf26/lib/python3.8/site-packages/keras/utils/generic_utils.py:494: CustomMaskWarning: Custom mask layers require a config and must
 override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.                                                         warnings.warn('Custom mask layers require a config and must override '
[Sigma] Epoch 1: sigma_cls=1.2836 sigma_reg=1.2933
Epoch 2/30
1067/1067 [==============================] - 9s 8ms/step - loss: 3.2839 - cls_loss: 0.1825 - reg_loss: 0.0040 - intention_accuracy: 0.6298 - val_loss: 2.2911 -
 val_cls_loss: 0.3006 - val_reg_loss: 0.0042 - val_intention_accuracy: 0.6198                                                                                  [Sigma] Epoch 2: sigma_cls=1.2303 sigma_reg=1.2386
Epoch 3/30
1067/1067 [==============================] - 9s 9ms/step - loss: 1.7173 - cls_loss: 0.1655 - reg_loss: 0.0028 - intention_accuracy: 0.6457 - val_loss: 1.4169 -
 val_cls_loss: 0.2561 - val_reg_loss: 0.0016 - val_intention_accuracy: 0.5909                                                                                  [Sigma] Epoch 3: sigma_cls=1.1770 sigma_reg=1.1834
Epoch 4/30
1067/1067 [==============================] - 9s 9ms/step - loss: 1.1105 - cls_loss: 0.1591 - reg_loss: 0.0023 - intention_accuracy: 0.6598 - val_loss: 0.9830 -
 val_cls_loss: 0.2519 - val_reg_loss: 0.0026 - val_intention_accuracy: 0.6033                                                                                  [Sigma] Epoch 4: sigma_cls=1.1245 sigma_reg=1.1280
Epoch 5/30
1067/1067 [==============================] - 10s 9ms/step - loss: 0.7517 - cls_loss: 0.1489 - reg_loss: 0.0021 - intention_accuracy: 0.6776 - val_loss: 0.7601 
- val_cls_loss: 0.3094 - val_reg_loss: 0.0017 - val_intention_accuracy: 0.5455                                                                                 [Sigma] Epoch 5: sigma_cls=1.0722 sigma_reg=1.0724
Epoch 6/30
1067/1067 [==============================] - 9s 9ms/step - loss: 0.5124 - cls_loss: 0.1430 - reg_loss: 0.0021 - intention_accuracy: 0.7015 - val_loss: 0.5607 -
 val_cls_loss: 0.2904 - val_reg_loss: 0.0025 - val_intention_accuracy: 0.6446                                                                                  [Sigma] Epoch 6: sigma_cls=1.0208 sigma_reg=1.0166
Epoch 7/30
1067/1067 [==============================] - 13s 12ms/step - loss: 0.3290 - cls_loss: 0.1323 - reg_loss: 0.0020 - intention_accuracy: 0.7184 - val_loss: 0.4596
 - val_cls_loss: 0.3261 - val_reg_loss: 0.0014 - val_intention_accuracy: 0.5124                                                                                [Sigma] Epoch 7: sigma_cls=0.9693 sigma_reg=0.9607
Epoch 8/30
1067/1067 [==============================] - 22s 20ms/step - loss: 0.1791 - cls_loss: 0.1259 - reg_loss: 0.0018 - intention_accuracy: 0.7268 - val_loss: 0.5022
 - val_cls_loss: 0.4549 - val_reg_loss: 0.0018 - val_intention_accuracy: 0.6240                                                                                [Sigma] Epoch 8: sigma_cls=0.9192 sigma_reg=0.9046
Epoch 9/30
1067/1067 [==============================] - 22s 21ms/step - loss: 0.0489 - cls_loss: 0.1244 - reg_loss: 0.0017 - intention_accuracy: 0.7324 - val_loss: 0.2755
 - val_cls_loss: 0.3432 - val_reg_loss: 0.0020 - val_intention_accuracy: 0.5372                                                                                [Sigma] Epoch 9: sigma_cls=0.8709 sigma_reg=0.8483
Epoch 10/30
1067/1067 [==============================] - 22s 21ms/step - loss: -0.0904 - cls_loss: 0.1127 - reg_loss: 0.0016 - intention_accuracy: 0.7784 - val_loss: 0.236
0 - val_cls_loss: 0.3736 - val_reg_loss: 0.0026 - val_intention_accuracy: 0.5785                                                                               [Sigma] Epoch 10: sigma_cls=0.8223 sigma_reg=0.7919
Epoch 11/30
1067/1067 [==============================] - 22s 20ms/step - loss: -0.2172 - cls_loss: 0.1103 - reg_loss: 0.0015 - intention_accuracy: 0.7793 - val_loss: 0.221
0 - val_cls_loss: 0.4112 - val_reg_loss: 0.0016 - val_intention_accuracy: 0.4628                                                                               [Sigma] Epoch 11: sigma_cls=0.7751 sigma_reg=0.7352
Epoch 12/30
1067/1067 [==============================] - 22s 21ms/step - loss: -0.3723 - cls_loss: 0.0944 - reg_loss: 0.0015 - intention_accuracy: 0.8247 - val_loss: 0.334
5 - val_cls_loss: 0.5028 - val_reg_loss: 0.0015 - val_intention_accuracy: 0.5950                                                                               [Sigma] Epoch 12: sigma_cls=0.7272 sigma_reg=0.6783
Epoch 13/30
1067/1067 [==============================] - 22s 21ms/step - loss: -0.5101 - cls_loss: 0.0912 - reg_loss: 0.0015 - intention_accuracy: 0.8266 - val_loss: 0.365
3 - val_cls_loss: 0.5301 - val_reg_loss: 0.0019 - val_intention_accuracy: 0.6322                                                                               [Sigma] Epoch 13: sigma_cls=0.6825 sigma_reg=0.6210
Epoch 14/30
1067/1067 [==============================] - 22s 21ms/step - loss: -0.6469 - cls_loss: 0.0909 - reg_loss: 0.0014 - intention_accuracy: 0.8219 - val_loss: 0.276
9 - val_cls_loss: 0.5002 - val_reg_loss: 0.0010 - val_intention_accuracy: 0.6281                                                                               [Sigma] Epoch 14: sigma_cls=0.6416 sigma_reg=0.5635
Epoch 15/30
1067/1067 [==============================] - 17s 16ms/step - loss: -0.8175 - cls_loss: 0.0797 - reg_loss: 0.0014 - intention_accuracy: 0.8482 - val_loss: 0.629
9 - val_cls_loss: 0.6302 - val_reg_loss: 0.0013 - val_intention_accuracy: 0.6157                                                                               [Sigma] Epoch 15: sigma_cls=0.6013 sigma_reg=0.5055
Epoch 16/30
1067/1067 [==============================] - 11s 10ms/step - loss: -0.9752 - cls_loss: 0.0781 - reg_loss: 0.0013 - intention_accuracy: 0.8632 - val_loss: 0.388
3 - val_cls_loss: 0.5411 - val_reg_loss: 0.0012 - val_intention_accuracy: 0.7066                                                                               [Sigma] Epoch 16: sigma_cls=0.5664 sigma_reg=0.4469
Epoch 17/30
1067/1067 [==============================] - 11s 10ms/step - loss: -1.1271 - cls_loss: 0.0807 - reg_loss: 0.0014 - intention_accuracy: 0.8547 - val_loss: 0.590
6 - val_cls_loss: 0.6047 - val_reg_loss: 0.0011 - val_intention_accuracy: 0.5992                                                                               [Sigma] Epoch 17: sigma_cls=0.5389 sigma_reg=0.3878
Epoch 18/30
1067/1067 [==============================] - 12s 11ms/step - loss: -1.3246 - cls_loss: 0.0750 - reg_loss: 0.0013 - intention_accuracy: 0.8618 - val_loss: 0.289
3 - val_cls_loss: 0.5255 - val_reg_loss: 9.3572e-04 - val_intention_accuracy: 0.6653                                                                           [Sigma] Epoch 18: sigma_cls=0.5126 sigma_reg=0.3277
Epoch 19/30
1067/1067 [==============================] - 13s 12ms/step - loss: -1.5394 - cls_loss: 0.0725 - reg_loss: 0.0013 - intention_accuracy: 0.8782 - val_loss: 0.695
8 - val_cls_loss: 0.6388 - val_reg_loss: 9.8835e-04 - val_intention_accuracy: 0.5826                                                                           [Sigma] Epoch 19: sigma_cls=0.4906 sigma_reg=0.2665
Epoch 20/30
1067/1067 [==============================] - 20s 18ms/step - loss: -1.8075 - cls_loss: 0.0674 - reg_loss: 0.0012 - intention_accuracy: 0.8782 - val_loss: 0.654
2 - val_cls_loss: 0.6424 - val_reg_loss: 0.0011 - val_intention_accuracy: 0.6074                                                                               [Sigma] Epoch 20: sigma_cls=0.4696 sigma_reg=0.2035
Epoch 21/30
1067/1067 [==============================] - 22s 21ms/step - loss: -2.1369 - cls_loss: 0.0647 - reg_loss: 0.0012 - intention_accuracy: 0.8861 - val_loss: 0.070
5 - val_cls_loss: 0.5553 - val_reg_loss: 0.0010 - val_intention_accuracy: 0.5909                                                                               [Sigma] Epoch 21: sigma_cls=0.4512 sigma_reg=0.1386
Epoch 22/30
1067/1067 [==============================] - 22s 21ms/step - loss: -2.5683 - cls_loss: 0.0652 - reg_loss: 0.0012 - intention_accuracy: 0.8838 - val_loss: 0.496
0 - val_cls_loss: 0.6879 - val_reg_loss: 0.0014 - val_intention_accuracy: 0.6157                                                                               [Sigma] Epoch 22: sigma_cls=0.4361 sigma_reg=0.0743
Epoch 23/30
1067/1067 [==============================] - 23s 21ms/step - loss: -2.9665 - cls_loss: 0.0642 - reg_loss: 0.0011 - intention_accuracy: 0.8903 - val_loss: 0.188
5 - val_cls_loss: 0.6698 - val_reg_loss: 6.5819e-04 - val_intention_accuracy: 0.6364                                                                           [Sigma] Epoch 23: sigma_cls=0.4229 sigma_reg=0.0478
Epoch 24/30
1067/1067 [==============================] - 22s 21ms/step - loss: -3.1032 - cls_loss: 0.0624 - reg_loss: 9.1898e-04 - intention_accuracy: 0.8922 - val_loss: 0
.7288 - val_cls_loss: 0.7362 - val_reg_loss: 6.3916e-04 - val_intention_accuracy: 0.5744                                                                       [Sigma] Epoch 24: sigma_cls=0.4109 sigma_reg=0.0432
Epoch 25/30
1067/1067 [==============================] - 23s 21ms/step - loss: -3.1582 - cls_loss: 0.0644 - reg_loss: 8.1574e-04 - intention_accuracy: 0.8908 - val_loss: 0
.5208 - val_cls_loss: 0.6858 - val_reg_loss: 5.4088e-04 - val_intention_accuracy: 0.6570                                                                       [Sigma] Epoch 25: sigma_cls=0.4018 sigma_reg=0.0409
Epoch 26/30
1067/1067 [==============================] - 23s 21ms/step - loss: -3.2339 - cls_loss: 0.0591 - reg_loss: 7.6215e-04 - intention_accuracy: 0.8993 - val_loss: 2
.1972 - val_cls_loss: 0.9083 - val_reg_loss: 6.0742e-04 - val_intention_accuracy: 0.7107                                                                       [Sigma] Epoch 26: sigma_cls=0.3916 sigma_reg=0.0390
Epoch 27/30
1067/1067 [==============================] - 22s 21ms/step - loss: -3.2665 - cls_loss: 0.0593 - reg_loss: 7.2036e-04 - intention_accuracy: 0.8946 - val_loss: 2
.0590 - val_cls_loss: 0.8570 - val_reg_loss: 5.5924e-04 - val_intention_accuracy: 0.6322                                                                       [Sigma] Epoch 27: sigma_cls=0.3829 sigma_reg=0.0377
Epoch 28/30
1067/1067 [==============================] - 23s 22ms/step - loss: -3.3017 - cls_loss: 0.0591 - reg_loss: 6.7701e-04 - intention_accuracy: 0.8964 - val_loss: 0
.7475 - val_cls_loss: 0.6344 - val_reg_loss: 6.4351e-04 - val_intention_accuracy: 0.6694                                                                       [Sigma] Epoch 28: sigma_cls=0.3757 sigma_reg=0.0366
Epoch 29/30
1067/1067 [==============================] - 23s 21ms/step - loss: -3.3348 - cls_loss: 0.0564 - reg_loss: 6.6401e-04 - intention_accuracy: 0.9025 - val_loss: 1
.3970 - val_cls_loss: 0.6919 - val_reg_loss: 7.3231e-04 - val_intention_accuracy: 0.6736                                                                       [Sigma] Epoch 29: sigma_cls=0.3684 sigma_reg=0.0362
Epoch 30/30
1067/1067 [==============================] - 22s 21ms/step - loss: -3.3963 - cls_loss: 0.0553 - reg_loss: 6.0056e-04 - intention_accuracy: 0.9086 - val_loss: 1
.7712 - val_cls_loss: 0.7405 - val_reg_loss: 5.4487e-04 - val_intention_accuracy: 0.6529                                                                       [Sigma] Epoch 30: sigma_cls=0.3625 sigma_reg=0.0352

🎯 Training completed!
📁 All epoch models saved in: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s/epochs
Train model is saved to data/models/jaad/Transformer_depth/12Nov2025-23h21m34s/model.h5
Available metrics: ['loss', 'cls_loss', 'reg_loss', 'intention_accuracy', 'val_loss', 'val_cls_loss', 'val_reg_loss', 'val_intention_accuracy', 'sigma_cls', 'v
al_sigma_cls', 'sigma_reg', 'val_sigma_reg']                                                                                                                   Training plots saved to model directory
Wrote configs to data/models/jaad/Transformer_depth/12Nov2025-23h21m34s/configs.yaml
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 11s 5ms/step

======================================================================
🎯 MODEL TEST RESULTS 🎯
======================================================================
Accuracy:   0.6061
AUC:        0.5428
F1-Score:   0.7162
Precision:  0.6520
Recall:     0.7944
======================================================================

Model saved to data/models/jaad/Transformer_depth/12Nov2025-23h21m34s/

✅ 训练完成 (耗时: 9.4 分钟)
🔍 查找最新模型目录...
📁 找到模型目录: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s

🧪 开始测试模型...
2025-11-12 23:30:58.683148: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:58.687272: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:58.687389: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   🚀 开始测试模型目录: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s
✅ 配置文件加载成功
✅ 数据集初始化成功
🔄 生成测试数据...
---------------------------------------------------------
Generating action sequence data
fstride: 1
sample_type: beh
subset: default
height_rng: [0, inf]
squarify_ratio: 0
data_split_type: default
seq_type: crossing
min_track_size: 76
random_params: {'ratios': None, 'val_data': True, 'regen_data': False}
kfold_params: {'num_folds': 5, 'fold': 1}
---------------------------------------------------------
Generating database for jaad
jaad database loaded from /home/minshi/Pedestrian_Crossing_Intention_Prediction/JAAD/data_cache/jaad_database.pkl
---------------------------------------------------------
Generating crossing data
Split: test
Number of pedestrians: 276 
Total number of samples: 171 
✅ 测试数据生成完成
📁 找到 31 个模型文件

============================================================
进度: 1/31

🔍 测试模型: epoch_001_loss_5.0220_acc_0.5124.h5
2025-11-12 23:30:59.610273: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (o
neDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA                                                                     To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-12 23:30:59.611921: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:59.612086: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:59.612158: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:59.923232: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:59.923362: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:59.923440: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there
 must be at least one NUMA node, so returning NUMA node zero                                                                                                   2025-11-12 23:30:59.923511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 4141 MB m
emory:  -> device: 0, name: NVIDIA GeForce RTX 4060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.9                                              [DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
2025-11-12 23:31:00.913206: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2025-11-12 23:31:01.954095: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be l
ogged once.                                                                                                                                                    2025-11-12 23:31:02.312406: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8100
1881/1881 [==============================] - 11s 5ms/step
✅ 准确率: 0.6055, AUC: 0.6961, F1: 0.6470

============================================================
进度: 2/31

🔍 测试模型: epoch_002_loss_2.2911_acc_0.6198.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 10s 5ms/step
✅ 准确率: 0.6730, AUC: 0.7323, F1: 0.7221

============================================================
进度: 3/31

🔍 测试模型: epoch_003_loss_1.4169_acc_0.5909.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 11s 5ms/step
✅ 准确率: 0.6491, AUC: 0.7182, F1: 0.6774

============================================================
进度: 4/31

🔍 测试模型: epoch_004_loss_0.9830_acc_0.6033.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 13s 7ms/step
✅ 准确率: 0.6369, AUC: 0.7100, F1: 0.6570

============================================================
进度: 5/31

🔍 测试模型: epoch_005_loss_0.7601_acc_0.5455.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 18s 9ms/step
✅ 准确率: 0.6497, AUC: 0.7206, F1: 0.6931

============================================================
进度: 6/31

🔍 测试模型: epoch_006_loss_0.5607_acc_0.6446.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 19s 9ms/step
✅ 准确率: 0.6433, AUC: 0.6981, F1: 0.6982

============================================================
进度: 7/31

🔍 测试模型: epoch_007_loss_0.4596_acc_0.5124.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 18s 9ms/step
✅ 准确率: 0.6688, AUC: 0.7193, F1: 0.7141

============================================================
进度: 8/31

🔍 测试模型: epoch_008_loss_0.5022_acc_0.6240.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 14s 7ms/step
✅ 准确率: 0.6396, AUC: 0.6978, F1: 0.7011

============================================================
进度: 9/31

🔍 测试模型: epoch_009_loss_0.2755_acc_0.5372.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 11s 5ms/step
✅ 准确率: 0.6438, AUC: 0.6876, F1: 0.6898

============================================================
进度: 10/31

🔍 测试模型: epoch_010_loss_0.2360_acc_0.5785.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 10s 5ms/step
✅ 准确率: 0.6358, AUC: 0.6826, F1: 0.6946

============================================================
进度: 11/31

🔍 测试模型: epoch_011_loss_0.2210_acc_0.4628.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 9s 5ms/step
✅ 准确率: 0.5960, AUC: 0.6359, F1: 0.6442

============================================================
进度: 12/31

🔍 测试模型: epoch_012_loss_0.3345_acc_0.5950.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 9s 5ms/step
✅ 准确率: 0.5694, AUC: 0.6106, F1: 0.6705

============================================================
进度: 13/31

🔍 测试模型: epoch_013_loss_0.3653_acc_0.6322.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 10s 5ms/step
✅ 准确率: 0.6427, AUC: 0.6850, F1: 0.7221

============================================================
进度: 14/31

🔍 测试模型: epoch_014_loss_0.2769_acc_0.6281.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 11s 6ms/step
✅ 准确率: 0.5976, AUC: 0.6397, F1: 0.6992

============================================================
进度: 15/31

🔍 测试模型: epoch_015_loss_0.6299_acc_0.6157.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 17s 9ms/step
✅ 准确率: 0.6624, AUC: 0.6923, F1: 0.7362

============================================================
进度: 16/31

🔍 测试模型: epoch_016_loss_0.3883_acc_0.7066.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 18s 9ms/step
✅ 准确率: 0.6369, AUC: 0.6855, F1: 0.7301

============================================================
进度: 17/31

🔍 测试模型: epoch_017_loss_0.5906_acc_0.5992.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 15s 7ms/step
✅ 准确率: 0.5986, AUC: 0.6344, F1: 0.6959

============================================================
进度: 18/31

🔍 测试模型: epoch_018_loss_0.2893_acc_0.6653.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 10s 5ms/step
✅ 准确率: 0.6087, AUC: 0.6409, F1: 0.7100

============================================================
进度: 19/31

🔍 测试模型: epoch_019_loss_0.6958_acc_0.5826.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 9s 5ms/step
✅ 准确率: 0.5991, AUC: 0.6298, F1: 0.6930

============================================================
进度: 20/31

🔍 测试模型: epoch_020_loss_0.6542_acc_0.6074.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 9s 4ms/step
✅ 准确率: 0.6507, AUC: 0.6869, F1: 0.7248

============================================================
进度: 21/31

🔍 测试模型: epoch_021_loss_0.0705_acc_0.5909.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 9s 4ms/step
✅ 准确率: 0.6316, AUC: 0.6480, F1: 0.7055

============================================================
进度: 22/31

🔍 测试模型: epoch_022_loss_0.4960_acc_0.6157.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 9s 4ms/step
✅ 准确率: 0.5976, AUC: 0.6490, F1: 0.7099

============================================================
进度: 23/31

🔍 测试模型: epoch_023_loss_0.1885_acc_0.6364.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 10s 5ms/step
✅ 准确率: 0.6140, AUC: 0.6516, F1: 0.7166

============================================================
进度: 24/31

🔍 测试模型: epoch_024_loss_0.7288_acc_0.5744.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 16s 8ms/step
✅ 准确率: 0.6034, AUC: 0.6404, F1: 0.6920

============================================================
进度: 25/31

🔍 测试模型: epoch_025_loss_0.5208_acc_0.6570.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 18s 9ms/step
✅ 准确率: 0.6029, AUC: 0.6388, F1: 0.7193

============================================================
进度: 26/31

🔍 测试模型: epoch_026_loss_2.1972_acc_0.7107.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 18s 9ms/step
✅ 准确率: 0.6587, AUC: 0.6859, F1: 0.7592

============================================================
进度: 27/31

🔍 测试模型: epoch_027_loss_2.0590_acc_0.6322.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 18s 9ms/step
✅ 准确率: 0.6135, AUC: 0.6163, F1: 0.7190

============================================================
进度: 28/31

🔍 测试模型: epoch_028_loss_0.7475_acc_0.6694.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 17s 9ms/step
✅ 准确率: 0.6252, AUC: 0.6605, F1: 0.7294

============================================================
进度: 29/31

🔍 测试模型: epoch_029_loss_1.3970_acc_0.6736.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 17s 9ms/step
✅ 准确率: 0.6093, AUC: 0.6404, F1: 0.7139

============================================================
进度: 30/31

🔍 测试模型: epoch_030_loss_1.7712_acc_0.6529.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 17s 9ms/step
✅ 准确率: 0.6061, AUC: 0.6310, F1: 0.7162

============================================================
进度: 31/31

🔍 测试模型: model.h5
[DataGenerator] auto class_weight -> {0: 0.6257309941520468, 1: 0.3742690058479532}
1881/1881 [==============================] - 11s 5ms/step
✅ 准确率: 0.6061, AUC: 0.6310, F1: 0.7162

📊 结果已保存到: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s/test_results_20251112_233832.csv
📝 报告已保存到: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s/test_report_20251112_233832.txt

🏆 准确率最高的模型: epoch_002_loss_2.2911_acc_0.6198.h5 (准确率: 0.6730)
🗑️  开始清理epochs目录，将删除 30 个模型文件...
🗑️  已删除: epoch_010_loss_0.2360_acc_0.5785.h5
🗑️  已删除: epoch_029_loss_1.3970_acc_0.6736.h5
🗑️  已删除: epoch_014_loss_0.2769_acc_0.6281.h5
🗑️  已删除: epoch_013_loss_0.3653_acc_0.6322.h5
🗑️  已删除: epoch_021_loss_0.0705_acc_0.5909.h5
🗑️  已删除: epoch_019_loss_0.6958_acc_0.5826.h5
🗑️  已删除: epoch_009_loss_0.2755_acc_0.5372.h5
🗑️  已删除: epoch_023_loss_0.1885_acc_0.6364.h5
🗑️  已删除: epoch_011_loss_0.2210_acc_0.4628.h5
🗑️  已删除: epoch_001_loss_5.0220_acc_0.5124.h5
🗑️  已删除: epoch_008_loss_0.5022_acc_0.6240.h5
🗑️  已删除: epoch_018_loss_0.2893_acc_0.6653.h5
🗑️  已删除: epoch_022_loss_0.4960_acc_0.6157.h5
🗑️  已删除: epoch_003_loss_1.4169_acc_0.5909.h5
🗑️  已删除: epoch_020_loss_0.6542_acc_0.6074.h5
🗑️  已删除: epoch_006_loss_0.5607_acc_0.6446.h5
📋 已将最佳模型复制到: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s/epoch_002_loss_2.2911_acc_0.6198.h5
🗑️  已删除: epoch_002_loss_2.2911_acc_0.6198.h5
🗑️  已删除: epoch_024_loss_0.7288_acc_0.5744.h5
🗑️  已删除: epoch_012_loss_0.3345_acc_0.5950.h5
🗑️  已删除: epoch_028_loss_0.7475_acc_0.6694.h5
🗑️  已删除: epoch_026_loss_2.1972_acc_0.7107.h5
🗑️  已删除: epoch_025_loss_0.5208_acc_0.6570.h5
🗑️  已删除: epoch_027_loss_2.0590_acc_0.6322.h5
🗑️  已删除: epoch_007_loss_0.4596_acc_0.5124.h5
🗑️  已删除: epoch_004_loss_0.9830_acc_0.6033.h5
🗑️  已删除: epoch_015_loss_0.6299_acc_0.6157.h5
🗑️  已删除: epoch_005_loss_0.7601_acc_0.5455.h5
🗑️  已删除: epoch_017_loss_0.5906_acc_0.5992.h5
🗑️  已删除: epoch_016_loss_0.3883_acc_0.7066.h5
🗑️  已删除: epoch_030_loss_1.7712_acc_0.6529.h5
🗑️  已删除空的epochs目录
🔄 模型目录已重命名:
   原目录: 12Nov2025-23h21m34s
   新目录: 12Nov2025-23h21m34s_acc_0.6730

================================================================================
🎯 测试结果汇总
================================================================================
总模型数量: 31
成功测试: 31
失败测试: 0

📊 性能统计:
平均准确率: 0.6250 (±0.0258)
平均AUC: 0.6676 (±0.0347)
平均F1: 0.7038 (±0.0254)

🏆 最佳模型:
最高准确率: epoch_002_loss_2.2911_acc_0.6198.h5 (Acc: 0.6730)
最高AUC: epoch_002_loss_2.2911_acc_0.6198.h5 (AUC: 0.7323)
最高F1: epoch_026_loss_2.1972_acc_0.7107.h5 (F1: 0.7592)

✅ 测试完成 (耗时: 7.6 分钟)

================================================================================
🎉 训练和测试管道完成!
================================================================================
模型目录: data/models/jaad/Transformer_depth/12Nov2025-23h21m34s
总耗时: 17.1 分钟
结束时间: 2025-11-12 23:38:34
================================================================================
